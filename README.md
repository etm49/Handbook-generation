# Handbook-generation EPI Demo

Automatically update statistical values in indicator analysis word docs

### Folder Structure
- **word doc/input** Analysis word docx documents to be read in by notebook (updated). Values to be updated should be in brackets. For instance, So the sentence: **“Anguilla has the lowest index value in SIDS of 31.5, which is above the SIDS average index value of 27.5”** would be changed to: **“{ohi-index,minSids, countryName} has the lowest index value of {ohi-index,minSids, value}, which is above the SIDS average index value of {ohi-index,avePacific, value}** 
- **word doc/ouputs** word docx documents generated by notebook

- **indicator data** folder for containing the indicatorData dataset and undpSids.json. Place indicatorData here or update data_path in notebook to indicatorData parent folder location

- **Notebook** folder for experimental notebooks
	- *handbook generator.ipynb* notebook for generating first page of EPI analysis with updated statistical values. Codes for caluclating the values and outputs are defined in the notebook

- **Scripts** contains the script formats for automated update of handbook catalouge.
	- *commons.py* contains the paths for the indicatorData and indicatorMeta datasets. Additionally, paths of the input word docx to be updated and output path generated docx are specified
	- *enums.py* this script contains the currently defined statistics updates. Whenever, a new statistics needs to be updated, define it here and write the code for calculating it in the statsCalculator function in UpdateText.py
	- *UpdateText.py* constains the stat calculator and code for updating a properly defined word docx. To update docx, place in word doc/input (or update input path in commons) and run this script. You will be asked the name of the word doc and the year for which you want to calculate the updates
	- *utlis.py* contains helper functions

### Updating a word doc file

- Encode the statistics to be updated according to {indicator,stats,output} format described above
- Place the word document in the **word doc/input** folder or alternatively, update the input path in **commons.py** file
- run the **UpdateText.py** script. You will be propmted to input the name of the word doc you want to update and the year for which you want to calculate new statistics.
- the updated word doc will be placed in the **word doc/output** folder.


### Current shortcomings

- Encoded texts (stats) embedded inside text box in the input docx are not updated. The proposed solution for this is to replace text boxes with 1 by 1 tables and remove the table border shadings. 
- Second, if encoded statistics are inside stylized text (for instance, text with different color, etc.), they lose their stylization in the output word doc. Currently, we are exploring ways of manipulating the runs method in docx package to maintain style. 